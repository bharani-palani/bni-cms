(this["webpackJsonpawzy-cms"]=this["webpackJsonpawzy-cms"]||[]).push([[4],{164:function(e,t){},166:function(e,t){},205:function(e,t){},207:function(e,t){},306:function(e,t,n){"use strict";n.r(t);var r=n(29),c=n(31),a=n(34),i=n(1),s=Object(i.createContext)([{},function(){}]),u=n(140),o=n.n(u).a.create({baseURL:"https://bharani.tech/services"}),f=n(30),l=n(4),p=n(5),h=n(298),b=n(304),d=n(269),y=n(299),j=n(300),g=n(206),w=n.n(g),O="web",v=function(){function e(t){var n=this;Object(l.a)(this,e),this.uploadFile=function(e){return new y.a({client:new h.a(n.config),leavePartsOnError:!1,params:Object(f.a)(Object(f.a)({},e),{},{Bucket:n.Bucket})})},this.deleteFile=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(f.a)({Bucket:n.Bucket},Object.keys(t).length>0&&Object(f.a)({},t)),a=new b.a(n.config).deleteObject(c),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteFolder=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t,c){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={Bucket:n.Bucket,Prefix:t},new b.a(n.config).listObjects(a,(function(e,t){if(e)return c({status:"fail"});0===t.Contents.length&&c({status:"success"}),(a={Bucket:n.Bucket}).Delete={Objects:[]},t.Contents.forEach((function(e){a.Delete.Objects.push({Key:e.Key})})),new b.a(n.config).deleteObjects(a,(function(e,t){if(e)return c({status:"fail"});t.IsTruncated?n.self.deleteFolder(n.Bucket,c):c({status:"success"})}))}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.renameFile=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.Bucket,e.abrupt("return",new b.a(n.config).copyObject({Bucket:c,CopySource:"".concat(c,"/").concat(t.oldKey),Key:t.newKey},(function(){new b.a(n.config).deleteObject({Bucket:c,Key:t.oldKey})})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.renameFolder=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var a,i,s,u,o,f;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.Bucket,i="".concat(t.oldKey,"/"),s="".concat(t.newKey),e.prev=3,e.next=6,new b.a(n.self.config).listObjects({Bucket:a,Prefix:i});case 6:return u=e.sent,o=u.Contents,f=u.Prefix,e.next=11,Promise.all(o.map(function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={Bucket:a,CopySource:"".concat(a,"/").concat(t.Key),Key:"".concat(s,"/").concat(t.Key.replace(f,""))},e.next=3,new b.a(n.self.config).copyObject(c);case 3:return i={Bucket:a,Key:t.Key},e.next=6,new b.a(n.self.config).deleteObject(i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),this.isUrlInternal=function(e){return"https:"!==(e?e.split("/"):["/"])[0]},this.getSignedUrl=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c,a,i,s,u,o,f;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isUrlInternal(t)){e.next=13;break}return c=t.split("/").slice(1,t.length).join("/"),a=t?t.split("/"):["/"],i=a[a.length-1].split(".").pop(),s={Bucket:n.Bucket,Key:c,expiresIn:n.expiresIn},u=new h.a(n.config),o=new d.a(s),e.next=9,Object(j.a)(u,o,{expiresIn:n.expiresIn});case 9:return f=e.sent,e.abrupt("return",{url:f,path:c,extension:i});case 13:return e.abrupt("return",{url:t,path:"",extension:""});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.downloadToBrowser=function(e){var t=e.split("/"),r=t[t.length-1],c=e.split("/").slice(1,e.split("/").length).join("/");n.getSignedUrl(c,n.expiresIn,n.Bucket).then((function(e){var t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("href",e),t.setAttribute("download",r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},this.fetchStream=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var a,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new h.a(n.config),e.next=3,a.send(new d.a({Bucket:n.Bucket,Key:t})).then(function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n,c,a,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.Body.pipeThrough(new TextDecoderStream("utf-8")).getReader(),c=[];case 2:return e.next=5,n.read();case 5:if(a=e.sent,i=a.value,!a.done){e.next=10;break}return e.abrupt("break",13);case 10:c.push(i),e.next=2;break;case 13:return s=c.join(""),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.Bucket=t.aws_s3_bucket,this.expiresIn=86400,this.config={region:w.a.AES.decrypt(t.aws_s3_region,t[O]).toString(w.a.enc.Utf8),credentials:{accessKeyId:w.a.AES.decrypt(t.aws_s3_access_key_id,t[O]).toString(w.a.enc.Utf8),secretAccessKey:w.a.AES.decrypt(t.aws_s3_secret_access_key,t[O]).toString(w.a.enc.Utf8)}},this.self=this}return Object(p.a)(e,[{key:"getBuckeName",value:function(){return this.Bucket}},{key:"fetchFileFolder",value:function(e){var t=Object(f.a)({Bucket:this.Bucket},Object.keys(e).length>0&&Object(f.a)({},e));return new b.a(this.config).listObjects(t)}}]),e}(),m=n(65),k=function(){function e(t){var n=this;Object(l.a)(this,e),this.uploadFile=function(e){var t=new m;return t.done=function(){var r={onUploadProgress:function(n){var r={loaded:n.loaded,total:n.total,Key:e.Key};t.emit("httpUploadProgress",r)}},c=new FormData;return c.append("X-Access-Key",n.config.fileStorageAccessKey),c.append("file",e.Body),c.append("folder",e.Key.split("/").slice(0,-1).join("/")),o.post("/api/media/upload",c,r)},t},this.renameFile=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new URLSearchParams({fromFileURL:t.oldKey,toFileURL:t.newKey,"X-Access-Key":n.config.fileStorageAccessKey}).toString(),e.abrupt("return",o.get("/api/media/renameFile?".concat(c)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.renameFolder=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new URLSearchParams({fromFileURL:t.oldKey,toFileURL:t.newKey,"X-Access-Key":n.config.fileStorageAccessKey}).toString(),e.abrupt("return",o.get("/api/media/renameFile?".concat(c)));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteFolder=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t,c){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new URLSearchParams({fileURL:t,"X-Access-Key":n.config.fileStorageAccessKey}).toString(),o.get("/api/media/deleteFile?".concat(a)).then((function(e){return c({status:"success"})})).catch((function(){return c({status:"fail"})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.isUrlInternal=function(e){return"https:"!==(e?e.split("/"):["/"])[0]},this.getSignedUrl=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c,a,i,s,u,o,f=arguments;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=f.length>1&&void 0!==f[1]?f[1]:"0",!n.isUrlInternal(t)){e.next=10;break}return a=t.split("/").slice(1,t.length).join("/"),i=t?t.split("/"):["/"],s=i[i.length-1].split(".").pop(),u=new URLSearchParams({fileURL:a,"X-Access-Key":n.config.fileStorageAccessKey,downloadable:c}).toString(),o="".concat("https://bharani.tech/services","/api/media/render?").concat(u),e.abrupt("return",{url:o,path:a,extension:s});case 10:return e.abrupt("return",{url:t,path:"",extension:""});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.downloadToBrowser=function(e){var t=e.split("/"),r=t[t.length-1];n.getSignedUrl(e,"1").then((function(e){var t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("href",e.url),t.setAttribute("download",r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},this.fetchStream=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var a,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({fileURL:t,"X-Access-Key":n.config.fileStorageAccessKey}).toString(),i="".concat("https://bharani.tech/services","/api/media/render?").concat(a),e.abrupt("return",fetch(i).then(function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n,c,a,i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.body.pipeThrough(new TextDecoderStream("utf-8")).getReader(),c=[];case 2:return e.next=5,n.read();case 5:if(a=e.sent,i=a.value,!a.done){e.next=10;break}return e.abrupt("break",13);case 10:c.push(i),e.next=2;break;case 13:return s=c.join(""),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.Bucket="",this.config={fileStorageAccessKey:t.fileStorageAccessKey}}return Object(p.a)(e,[{key:"getBuckeName",value:function(){return this.Bucket}},{key:"fetchFileFolder",value:function(e){var t=new URLSearchParams(e).toString();return o.get("/api/media/getList?X-Access-Key=".concat(this.config.fileStorageAccessKey,"&").concat(t)).then((function(e){return{Contents:e.data.response.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{LastModified:new Date(e.LastModified)})}))}}))}}]),e}(),x=function(e,t){switch(e){case"AWSS3":return{library:new v(t)};case"SELF":return{library:new k(t)};default:return{library:null}}},S=(n(40),n(270),n.p,n.p,n(0)),K=(n(305),n(271),function(e){return(e?e.split("/"):["/"])[0]});t.default=function(e){var t=Object(i.useState)({}),n=Object(a.a)(t,2),u=n[0],f=n[1],l=Object(i.useState)(!0),p=Object(a.a)(l,2),h=p[0],b=p[1],d=function(){var e=Object(c.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!1),e.next=3,o.get("/").then((function(e){var t=e.data.response[0];f(t),b(!0),y(t),document.documentElement.style.setProperty("--az-theme-color",t.webThemeColor),document.documentElement.style.setProperty("--az-theme-bg-color",t.webThemeBackground)})).catch((function(e){return b(!1)})).finally((function(e){return!1}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(e){var t=document.querySelector("#favIcon"),n=K(e.favIconImg);x(n,e).library.getSignedUrl(e.favIconImg).then((function(e){t.href=e.url||""}))};return Object(i.useEffect)((function(){d()}),[]),Object(S.jsx)(S.Fragment,{children:h&&Object(S.jsx)(s.Provider,{value:[u,f],children:Object(S.jsx)("h1",{children:"Hello world"})})})}}}]);
//# sourceMappingURL=4.0b61e16c.chunk.js.map